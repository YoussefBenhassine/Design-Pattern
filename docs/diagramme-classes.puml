@startuml Diagramme de Classes - Application de Réservation

' Modèles de domaine
abstract class User {
    - String id
    - String name
    - String email
    - String phone
    + getId() : String
    + getName() : String
    + getEmail() : String
    + getPhone() : String
    + {abstract} getRole() : String
}

class Client extends User {
    + getRole() : String
}

class Prestataire extends User {
    - List<String> serviceIds
    - double rating
    - int totalReviews
    + addService(String)
    + updateRating(double)
}

class Admin extends User {
    + getRole() : String
}

class Service {
    - String id
    - String name
    - String description
    - String category
    - BigDecimal price
    - int duration
    - String prestataireId
}

class Reservation {
    - String id
    - String clientId
    - String serviceId
    - String prestataireId
    - LocalDateTime dateTime
    - ReservationStatus status
    - BigDecimal totalAmount
    + cancel()
}

enum ReservationStatus {
    PENDING
    CONFIRMED
    CANCELLED
    COMPLETED
}

class Payment {
    - String id
    - String reservationId
    - BigDecimal amount
    - PaymentMethod method
    - PaymentStatus status
    - LocalDateTime paymentDate
}

enum PaymentMethod {
    CREDIT_CARD
    PAYPAL
    WALLET
}

class Notification {
    - String id
    - String userId
    - String message
    - NotificationType type
    - LocalDateTime createdAt
    - boolean read
    + markAsRead()
}

' Design Patterns - Strategy
interface PaymentStrategy {
    + processPayment(BigDecimal, String) : boolean
    + getMethodName() : String
}

class CreditCardPaymentStrategy implements PaymentStrategy
class PayPalPaymentStrategy implements PaymentStrategy
class WalletPaymentStrategy implements PaymentStrategy

' Design Patterns - Factory
class UserFactory {
    + {static} createUser(UserType, String, String, String, String) : User
}

enum UserType {
    CLIENT
    PRESTATAIRE
    ADMIN
}

' Design Patterns - Observer
interface NotificationObserver {
    + update(Notification)
}

interface NotificationSubject {
    + attach(NotificationObserver)
    + detach(NotificationObserver)
    + notifyObservers(Notification)
}

class EmailNotificationObserver implements NotificationObserver
class SMSNotificationObserver implements NotificationObserver
class InAppNotificationObserver implements NotificationObserver

' Design Patterns - Repository
interface Repository<T, ID> {
    + save(T) : T
    + findById(ID) : Optional<T>
    + findAll() : List<T>
    + deleteById(ID)
    + existsById(ID) : boolean
}

class UserRepository implements Repository<User, String>
class ServiceRepository implements Repository<Service, String>
class ReservationRepository implements Repository<Reservation, String>
class PaymentRepository implements Repository<Payment, String>

' Design Patterns - Builder
class ReservationBuilder {
    - String id
    - String clientId
    - String serviceId
    - String prestataireId
    - LocalDateTime dateTime
    - BigDecimal totalAmount
    + withId(String) : ReservationBuilder
    + withClientId(String) : ReservationBuilder
    + withServiceId(String) : ReservationBuilder
    + withPrestataireId(String) : ReservationBuilder
    + withDateTime(LocalDateTime) : ReservationBuilder
    + withTotalAmount(BigDecimal) : ReservationBuilder
    + build() : Reservation
}

' Design Patterns - Facade
class ReservationFacade {
    - ReservationService reservationService
    - PaymentService paymentService
    - NotificationService notificationService
    + completeReservation(...) : Reservation
    + cancelReservationWithRefund(String)
}

' Services
class UserService {
    - UserRepository userRepository
    + createUser(...) : User
    + findUserById(String) : Optional<User>
}

class ReservationService {
    - ReservationRepository reservationRepository
    - ServiceRepository serviceRepository
    - NotificationService notificationService
    + createReservation(...) : Reservation
    + cancelReservation(String)
    + updateReservation(...) : Reservation
}

class PaymentService {
    - PaymentRepository paymentRepository
    - PaymentStrategy paymentStrategy
    + setPaymentStrategy(PaymentStrategy)
    + processPayment(...) : Payment
    + refundPayment(String)
}

class NotificationService implements NotificationSubject {
    - List<NotificationObserver> observers
    + sendNotification(...) : Notification
    + sendReservationConfirmation(...)
}

class ServiceSearchService {
    - ServiceRepository serviceRepository
    + searchAll() : List<Service>
    + searchByCategory(String) : List<Service>
}

' Couche Interface Utilisateur (UI)
class MainWindow extends JFrame {
    - ReservationFacade reservationFacade
    - UserService userService
    - ServiceSearchService searchService
    - ReservationService reservationService
    - NotificationService notificationService
    - JTabbedPane tabbedPane
    + initializeGUI()
    + refreshAllPanels()
}

class ServiceSearchPanel extends JPanel {
    - ServiceSearchService searchService
    - JTable serviceTable
    + refresh()
    + getSelectedService() : Service
}

class ReservationPanel extends JPanel {
    - ReservationFacade reservationFacade
    - ServiceSearchService searchService
    - JComboBox<String> serviceCombo
    - JTextField paymentDetailsField
    + refresh()
}

class HistoryPanel extends JPanel {
    - ReservationService reservationService
    - JTable reservationTable
    + refresh(String clientId)
}

class UserPanel extends JPanel {
    - UserService userService
    - JTable userTable
    + refresh()
}

' Relations
Reservation "1" --> "1" Service
Reservation "1" --> "1" Client
Reservation "1" --> "1" Prestataire
Payment "1" --> "1" Reservation
Notification "1" --> "1" User

PaymentService "uses" --> PaymentStrategy
UserService "uses" --> UserFactory
ReservationService "uses" --> ReservationBuilder
ReservationFacade "uses" --> ReservationService
ReservationFacade "uses" --> PaymentService
ReservationFacade "uses" --> NotificationService
NotificationService "notifies" --> NotificationObserver

' Relations UI
MainWindow "contains" --> ServiceSearchPanel
MainWindow "contains" --> ReservationPanel
MainWindow "contains" --> HistoryPanel
MainWindow "contains" --> UserPanel
MainWindow "uses" --> ReservationFacade
MainWindow "uses" --> UserService
MainWindow "uses" --> ServiceSearchService
MainWindow "uses" --> ReservationService
ServiceSearchPanel "uses" --> ServiceSearchService
ReservationPanel "uses" --> ReservationFacade
ReservationPanel "uses" --> ServiceSearchService
HistoryPanel "uses" --> ReservationService
UserPanel "uses" --> UserService

@enduml

